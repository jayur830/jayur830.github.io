1:"$Sreact.fragment"
32:I[897367,["/_next/static/chunks/d96012bcfc98706a.js","/_next/static/chunks/d80b3790a119a285.js"],"OutletBoundary"]
33:"$Sreact.suspense"
:HL["/_next/static/chunks/b9ef641e76e3a351.css","style"]
0:{"buildId":"mw_8NOeE36EaX7Y8wJXXi","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"max-w-[1440px] w-full mx-auto px-6 py-12","children":[["$","header",null,{"className":"mb-8","children":[["$","h1",null,{"className":"text-4xl font-bold mb-2","children":"[Refactoring] JSCodeShift"}],["$","div",null,{"className":"text-sm text-zinc-500 dark:text-zinc-400","children":"2024-03-22"}]]}],["$","article",null,{"className":"prose","children":[["$","h3","h3-0",{"children":"Refactoring"}],"\n",["$","p","p-0",{"children":"회사에서든 혼자든 개발/유지보수를 하다보면 리팩토링(Refactoring)이라는 과정을 꼭 하곤 한다."}],"\n",["$","p","p-1",{"children":"리팩토링(Refactoring)이란, 코드의 내부 동작을 효율적이고 깔끔하게 하여 유지보수의 생산성을 올리되, 코드 동작의 결과는 이전과 똑같이 하는 과정을 의미한다. 그 중 하나는 이름 바꾸기라던가, 불필요한 코드를 없앤다던가 등이 있는데, 프로젝트의 규모가 방대할 수록 사람의 손으로 일일히 다 찾아서 수정하는 것은 불가능에 가깝다."}],"\n",["$","p","p-2",{"children":"이 페이지에서는 원하는 부분의 코드 수정을 단시간에 자동으로 해주는 툴을 소개하려고 한다."}],"\n",["$","h3","h3-1",{"children":["$","strong","strong-0",{"children":"AST Tree"}]}],"\n",["$","h3","h3-2",{"children":"JSCodeShift"}],"\n",["$","p","p-3",{"children":"아래는 하나의 예시다. 실제로 내가 필요에 의해 진행했던 작업이다."}],"\n",["$","p","p-4",{"children":["JSX 엘리먼트 중 ",["$","code","code-0",{"children":"color=\"blue600\""}]," 이라는 Attribute를 갖는 엘리먼트를 찾아서 ",["$","code","code-1",{"children":"color={Colors.blue['600']}"}]," 로 바꾸고, 이 때 ",["$","code","code-2",{"children":"Colors"}]," 라는 변수가 import 되어야하기 때문에 만약 import 되어있지 않으면 import 해주는 코드를 최상단에 추가하도록 하고 싶었다."]}],"\n",["$","pre","pre-0",{"children":["$","code","code-0",{"className":"hljs language-typescript","children":[["$","span","span-0",{"className":"hljs-comment","children":"// transform.js"}],"\n\n",["$","span","span-1",{"className":"hljs-comment","children":["/** ",["$","span","span-0",{"className":"hljs-doctag","children":"@type"}]," import('jscodeshift').Transform */"]}],"\n",["$","span","span-2",{"className":"hljs-keyword","children":"function"}]," ",["$","span","span-3",{"className":"hljs-title function_","children":"transform"}],"(",["$","span","span-4",{"className":"hljs-params","children":"file, { j }"}],") {\n\t",["$","span","span-5",{"className":"hljs-comment","children":"// 파일의 내용 파싱"}],"\n  ",["$","span","span-6",{"className":"hljs-keyword","children":"const"}]," tree = ",["$","span","span-7",{"className":"hljs-title function_","children":"j"}],"(file.",["$","span","span-8",{"className":"hljs-property","children":"source"}],");\n\n\t",["$","span","span-9",{"className":"hljs-comment","children":"// AS-IS"}],"\n  ",["$","span","span-10",{"className":"hljs-keyword","children":"const"}]," src = ",["$","span","span-11",{"className":"hljs-string","children":"'blue600'"}],";\n  ",["$","span","span-12",{"className":"hljs-comment","children":"// TO-BE"}],"\n  ",["$","span","span-13",{"className":"hljs-keyword","children":"const"}]," dst = ",["$","span","span-14",{"className":"hljs-string","children":"\"{Colors.blue['600']}\""}],";\n\n  ",["$","span","span-15",{"className":"hljs-keyword","children":"const"}]," nodes = tree.",["$","span","span-16",{"className":"hljs-title function_","children":"find"}],"(\n\t  ",["$","span","span-17",{"className":"hljs-comment","children":"// JSX Attribute가"}],"\n\t  j.",["$","span","span-18",{"className":"hljs-property","children":"JSXAttribute"}],",\n\t  ",["$","span","span-19",{"className":"hljs-comment","children":"// `color=\"blue600\"` 인 엘리먼트를 찾는다."}],"\n\t  ",["$","span","span-20",{"className":"hljs-function","children":[["$","span","span-0",{"className":"hljs-params","children":"node"}]," =>"]}]," {\n\t    ",["$","span","span-21",{"className":"hljs-keyword","children":"return"}]," node.",["$","span","span-22",{"className":"hljs-property","children":"name"}],".",["$","span","span-23",{"className":"hljs-property","children":"name"}]," === ",["$","span","span-24",{"className":"hljs-string","children":"'color'"}]," && node.",["$","span","span-25",{"className":"hljs-property","children":"value"}],".",["$","span","span-26",{"className":"hljs-property","children":"value"}]," === src;\n\t  },\n  );\n\n\t",["$","span","span-27",{"className":"hljs-comment","children":"// 찾음"}],"\n  ",["$","span","span-28",{"className":"hljs-keyword","children":"if"}]," (nodes.",["$","span","span-29",{"className":"hljs-property","children":"length"}]," > ",["$","span","span-30",{"className":"hljs-number","children":"0"}],") {\n\t  ","$L2","\n\t  ","$L3","\n    ","$L4"," colorsImported = tree.","$L5","(\n\t    j.","$L6",",\n\t    ","$L7"," {\n\t\t    ","$L8"," node.","$L9",".","$La"," === ","$Lb",";\n\t    },\n\t  );\n\t  ","$Lc","\n    ","$Ld"," (colorsImported.","$Le"," === ","$Lf",") {\n\t    ","$L10","\n      tree.","$L11","(j.","$L12",")\n\t      ","$L13","\n\t      .","$L14","(","$L15",")\n\t      ","$L16","\n\t      .","$L17","(\n\t\t      j.","$L18","(\n\t\t\t      ","$L19","\n\t\t\t      [j.","$L1a","(j.","$L1b","(","$L1c","))],\n\t\t\t      ","$L1d","\n\t\t\t      j.","$L1e","(","$L1f","),\n\t\t\t    ),\n\t\t\t  );\n    }\n\n\t\t","$L20","\n    nodes.","$L21","(","$L22"," {\n      node.","$L23","(j.","$L24","(j.","$L25","(","$L26","), j.","$L27","(dst)));\n    });\n  }\n\n\t","$L28","\n  ","$L29"," tree.","$L2a","();\n}\n"]}]}],"\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f"]}]]}],["$L30"],"$L31"]}],"loading":null,"isPartial":false}
2:["$","span","span-31",{"className":"hljs-comment","children":"// `'@/constants/color'` 로부터 import 하는 코드 존재 여부"}]
3:["$","span","span-32",{"className":"hljs-comment","children":"// Colors 변수가 이 source에 있음"}]
4:["$","span","span-33",{"className":"hljs-keyword","children":"const"}]
5:["$","span","span-34",{"className":"hljs-title function_","children":"find"}]
6:["$","span","span-35",{"className":"hljs-property","children":"ImportDeclaration"}]
7:["$","span","span-36",{"className":"hljs-function","children":[["$","span","span-0",{"className":"hljs-params","children":"node"}]," =>"]}]
8:["$","span","span-37",{"className":"hljs-keyword","children":"return"}]
9:["$","span","span-38",{"className":"hljs-property","children":"source"}]
a:["$","span","span-39",{"className":"hljs-property","children":"value"}]
b:["$","span","span-40",{"className":"hljs-string","children":"'@/constants/color'"}]
c:["$","span","span-41",{"className":"hljs-comment","children":"/**\n\t   * 만약 `'@/constants/color'` 로부터 import 되어있지 않으면\n\t   * 파일 내 최상단에 import statement 추가\n\t   */"}]
d:["$","span","span-42",{"className":"hljs-keyword","children":"if"}]
e:["$","span","span-43",{"className":"hljs-property","children":"length"}]
f:["$","span","span-44",{"className":"hljs-number","children":"0"}]
10:["$","span","span-45",{"className":"hljs-comment","children":"// 파일 내 모든 import 문 중"}]
11:["$","span","span-46",{"className":"hljs-title function_","children":"find"}]
12:["$","span","span-47",{"className":"hljs-property","children":"ImportDeclaration"}]
13:["$","span","span-48",{"className":"hljs-comment","children":"// 첫 번째 라인"}]
14:["$","span","span-49",{"className":"hljs-title function_","children":"at"}]
15:["$","span","span-50",{"className":"hljs-number","children":"0"}]
16:["$","span","span-51",{"className":"hljs-comment","children":"// 윗 줄에 추가"}]
17:["$","span","span-52",{"className":"hljs-title function_","children":"insertBefore"}]
18:["$","span","span-53",{"className":"hljs-title function_","children":"importDeclaration"}]
19:["$","span","span-54",{"className":"hljs-comment","children":"// `Colors` 변수를 default로 import"}]
1a:["$","span","span-55",{"className":"hljs-title function_","children":"importDefaultSpecifier"}]
1b:["$","span","span-56",{"className":"hljs-title function_","children":"identifier"}]
1c:["$","span","span-57",{"className":"hljs-string","children":"'Colors'"}]
1d:["$","span","span-58",{"className":"hljs-comment","children":"// `'@/constants/color'` 로부터"}]
1e:["$","span","span-59",{"className":"hljs-title function_","children":"literal"}]
1f:["$","span","span-60",{"className":"hljs-string","children":"'@/constants/color'"}]
20:["$","span","span-61",{"className":"hljs-comment","children":"// `color={Colors.blue['600']}` 라는 코드로 치환"}]
21:["$","span","span-62",{"className":"hljs-title function_","children":"forEach"}]
22:["$","span","span-63",{"className":"hljs-function","children":[["$","span","span-0",{"className":"hljs-params","children":"node"}]," =>"]}]
23:["$","span","span-64",{"className":"hljs-title function_","children":"replace"}]
24:["$","span","span-65",{"className":"hljs-title function_","children":"jsxAttribute"}]
25:["$","span","span-66",{"className":"hljs-title function_","children":"jsxIdentifier"}]
26:["$","span","span-67",{"className":"hljs-string","children":"'color'"}]
27:["$","span","span-68",{"className":"hljs-title function_","children":"jsxText"}]
28:["$","span","span-69",{"className":"hljs-comment","children":"// 코드 내보내기"}]
29:["$","span","span-70",{"className":"hljs-keyword","children":"return"}]
2a:["$","span","span-71",{"className":"hljs-title function_","children":"toSource"}]
2b:["$","h3","h3-3",{"children":["$","strong","strong-0",{"children":"Reference"}]}]
2c:["$","p","p-5",{"children":["$","a","a-0",{"href":"https://github.com/facebook/jscodeshift?tab=readme-ov-file#transform-module","children":"bookmark"}]}]
2d:["$","p","p-6",{"children":["$","a","a-0",{"href":"https://toss.tech/article/jscodeshift","children":"bookmark"}]}]
2e:["$","p","p-7",{"children":["$","a","a-0",{"href":"https://medium.com/@bjrnt/codemod%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%BD%94%EB%93%9C-%EB%B3%80%ED%99%98-bf04e894f3f1","children":"bookmark"}]}]
2f:["$","p","p-8",{"children":["$","a","a-0",{"href":"https://velog.io/@chltjdrhd777/Typescript%EC%99%80-AST","children":"bookmark"}]}]
30:["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/b9ef641e76e3a351.css","precedence":"next"}]
31:["$","$L32",null,{"children":["$","$33",null,{"name":"Next.MetadataOutlet","children":"$@34"}]}]
34:null
